---
layout:     post
title:      "要想走得快，早到达，先抬头找到路的方向"
subtitle:   "近期开发的一点感悟"
date:       2020-03-01 12:39:00
author:     "aguozhang"
header-img: "img/post-bg-2015.jpg"
tags:
    - 感悟
    - 思考
    - 赶路
---

## 背景
最近在做一个需求，改造已有系统，增加新功能并同时废弃掉一些老功能。

通过调研，原来的系统功能其实很简单，但为了兼容前几次不同的需求，系统已经复杂到没有人能理解的地步了。

我看了很久代码也不能理解透原来的逻辑，但本次的需求怎么做，我心里很清楚。

现在遇到的问题就很清楚，做新需求的同时要不要兼容老的逻辑。领导要求是要兼容，现实是：臣妾真的做不到啊。

时间紧急，最重要的是本次需求赶紧做完并提测。

## 问题

本次需求很明了，原来众多的api都摆在那里。原来为什么有这个api, 为什么里面有这么奇怪的逻辑：不知道，谁也不知道

我第一时间方案：从原来的api出发，一个一个改造，保证原来api行为不变的情况下，改造系统内部。

没有过脑子，或者说被时间压变了形。一通代码啪啪啪后，总感觉哪里不对劲。
* 越开发感觉越乱，感觉掉进了一个深渊，不知道什么能到底
* 遇到一个地方，直接写代码进行替代，没有区分抽象和实现
* 这个工作没法拆分或者没有考虑进行拆分，有人也加不进来
我想很多人都熟悉这种场景，时间紧急，没有时间慢慢思考，抓到第一根稻草就不放，使劲往上爬，结果爬到一半，咕咚又掉下去了，这
次掉的更深，也更疼。  

其实只要多花点时间多看看周围，会发现稻草不止这么一根，说不定还有树枝垂下来呢。

## 正确做法
其实只要多想想，一个一个改造api其实是不现实的：
* 原来api的逻辑很多你是理解不了的，理解不了其实也没改
* 很多api即使不换路径，参数也要变，还是相当于换新的api
* 很多api费了半天劲改造，也许根本就没有人用呢
* 很多原来的api现在已经没有意义了
* 本次需求是要新增api, 新加和改造代码放一起，更乱了

想了想后，其实正确的做法很简单：与其吃别人的屎，不如彻底绕开，新起一摊。
* 本次需要用到的api全部重新写
* 老api和老的代码全部不动
* 不应该再调用的老api给注释掉，保证第一时间发现错误
* 先定api规格和各种服务的接口，细节留待慢慢实现


## 总结

* 思考再行动，搭好架子再填细节，
* 树枝胜过稻草
* 接口为先，用好书本知识
* 时间越急越不能乱了阵脚
* 有方案后，先去喝杯咖啡，回来再动手
* 要想走得快，先走好，欠过的债要补回来，童子军军规
* 思考和行动都要有

这只是工作中的一个小例子，却很典型。以后要养成定期复盘的好习惯。

