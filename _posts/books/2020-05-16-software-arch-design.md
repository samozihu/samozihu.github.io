---
layout:     post
title:      "软件架构设计 读后感"
subtitle:   "大型网站技术架构与业务架构整合之道"
date:       2020-05-16 16:00:00
author:     "aguozhang"
header-img: "img/post-bg-2015.jpg"
tags:
    - 架构 
    - 全面 
    - 中文好书
---

## 前言
这是豆瓣上推荐的，我一向对中文的技术书不太感冒，除了少数的几本。  
但这本书的评分不是一般的高，好奇之下买了来。  
果然是一本好书，同样作为架构师，只能感叹书的知识点还是非常全的。虽然感觉很多东西都是比较浅的,但作为一个指导书是非常好的。 
此书对我的作用不大，涉及的知识基本上都能掌握。但看完后第一时间推荐给了几个好友，可以增宽他们的知识面，对于今年的面试也是相当有帮助的，我相信

## 摘录
* 架构是针对所有重要问题做出的重要决策
* 基础架构 
* 中间件与大数据平台
* 业务系统架构
* 道与术 想看到道的效果却需要长期地修炼
* 缓冲io与直接io
* 应用程序内存 
* 用户缓冲区
* 内核缓冲区
* 内存映射文件
* 零拷贝
* 网络I/O模型
* 阻塞和非阻塞是从函数调用角度来说的，而同步和异步是从 “读写是谁完成的”角度来说的
* 阻塞：如果读写没有就绪或者读完没有完成，则该函数一直等待
* 非阻塞：函数立即返回，然后让应用程序轮询
* 同步： 读写由应用程序完成
* 异步： 读写由操作系统完成，完成之后，回调或者事件通知应用程序
* Reactor Proactor
* select poll epoll
* epoll LT ET 
* LT :写的死循环问题
* ET: 要避免 short read问题
* 服务器编程的 1 + N + M
* 无锁： 内存屏障与CAS
* 网络
* Pipeline与Head-of-line Blocking问题
* HTTP/2:现在相当于在HTTP1.1与TCP之间多了一个转换层，这个转换层就是SPDY,也就是现在的HTTP/2
* 二进制分帧
* TCP: 不漏 不重 不乱序
* QUIC: Quick UDP Internet connection
* 不丢包（Raid5算法和Raid6算法）
* 数据库
* B+树： 范围查询 前缀匹配模糊查询 排序与分页
* 事务的四个隔离级别
* 脏读
* 不可重复读
* 幻读
* 丢失更新
* RU(read uncommited)
* RC （Read commited)
* RR (Repeatable Read)
* Serialization
* 事务实现原理之1： Redo Log
* Write-Ahead
* I/O写入的原子性
* Double Write: 把16KB写入到一个临时的磁盘位置，写入成功后再拷贝到目标磁盘位置。这样，即使目标磁盘位置的16KB因为宕机被损坏了，还可以用备份去恢复
* 事务实现原理之2： Undo Log
* Undo Log不是Log，而是数据, 更应该叫作 备份数据，即在事务未提交之前的时间里的 备份数据
* 表锁，行锁， 意向锁 AI 间隙锁 临键锁 插入意向锁
* 框架 软件 中间件
* 高并发问题
* 读写分离（CQRS架构）
* 高并发写:
* 数据分片
* 任务分片
* 异步化
* 批量
* 串行化+多进程单线程+异步I/O
* 高可用与稳定性
* 多副本
* 隔离（数据隔离 机器隔离 线程池隔离 信号量隔离）
* 限流（技术和业务层面）（漏桶 令牌桶）
* 熔断
* 降级
* 事务一致性
* 2PC
* 最终一致性
* TCC
* 事务状态表 + 调用方重试 + 接收方幂等
* 对账
* 妥协方案： 弱一致性 + 基于状态的补偿
* 妥协方案：重试 + 回滚 + 报警 + 人工修复
* 多副本一致性
* Kafka的消息丢失问题
* LEO + HW
* Paxos
* Raft ： 为可理解性而设计
* Zab
* CAP理论
* 其实P是没有选择的
* 现实世界不存在“强一致性”（PACELC理论）
* 信息的传播需要时间
* 信息所反映的世界在变化
* 理论上不存在强一致性
* 分布式锁： 基于zookeeper实现
* 基于redis实现
* 业务架构与技术架构的区分
* 伪分层
* 边界思维 对象层面 接口层面 产品层面 组织架构层面
* 系统化思维
* 影响力的塑造：关键时候能顶上 打工思维与老板思维 空杯心态






